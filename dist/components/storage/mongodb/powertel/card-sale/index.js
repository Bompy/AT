"use strict";function makeConditions(e){return new Promise(function(o,t){var n={};e.cardId&&(n.cardId=mongoose.Types.ObjectId(e.cardId)),e.mdn&&(n.mdn=e.mdn),e.cost&&(n.cost=e.cost),e.conditions&&(e.conditions.withRouter&&(n["conditions.withRouter"]=e.conditions.withRouter),e.conditions.routerType&&(n["conditions.routerType"]=e.conditions.routerType)),e.textSearch&&(n.$text={$search:e.textSearch}),o(n)})}function makeSortCriteria(e){return new Promise(function(o,t){var n;n=e.criteria,"Descending"===e.order&&(n="-"+n),o(n)})}function generateAddDetails(e){var o=[];return e.forEach(function(e){var t={cardId:mongoose.Types.ObjectId(e.cardId),mdn:e.mdn,cost:e.cost};e.conditions&&(t.conditions={},e.conditions.withRouter&&(t.conditions.withRouter=e.conditions.withRouter),e.conditions.routerType&&(t.conditions.routerType=e.conditions.routerType)),o.push(t)}),o}function generateUpdateDetails(e,o){return new Promise(function(t,n){o.cardId&&(e.cardId=mongoose.Types.ObjectId(o.cardId)),o.mdn&&(e.mdn=o.mdn),o.cost&&(e.cost=o.cost),o.conditions&&(o.conditions.withRouter&&(e.conditions.withRouter=o.conditions.withRouter),o.conditions.routerType&&(e.conditions.routerType=o.conditions.routerType)),t(e)})}function convertToAbstract(e,o){return void 0===o&&(o=!1),this.checkThrow(o).then(function(o){return new Promise(function(o,t){var n=[];e.forEach(function(e){var o={id:e._id.toHexString(),cardId:e.cardId.toHexString(),mdn:e.mdn,cost:e.cost,createdAt:e.createdAt,updatedAt:e.updatedAt};e.conditions&&(o.conditions={},e.conditions.withRouter&&(o.conditions.withRouter=e.conditions.withRouter),e.conditions.routerType&&(o.conditions.routerType=e.conditions.routerType)),n.push(o)}),o(n)})})}Object.defineProperty(exports,"__esModule",{value:!0});var Promise=require("bluebird"),mongoose=require("mongoose"),generic_model_class_1=require("../../generic-model-class"),generic_event_class_1=require("../../generic-event-class"),model_1=require("./model");exports.default=function(e,o,t){var n=new generic_event_class_1.default(e,"Powertel|CardSale");return new generic_model_class_1.default(n,model_1.MongooseModel,o,t,makeConditions,makeSortCriteria,generateAddDetails,generateUpdateDetails,convertToAbstract)};