"use strict";function makeConditions(e){return new Promise(function(t,n){var o={};e.type&&(o.type=e.type),e.count&&(o.count={},e.count.min&&(o.count.$gte=e.count.min),e.count.max&&(o.count.$lte=e.count.max)),e.newStock&&(o.newStock={},e.newStock.min&&(o.newStock.$gte=e.newStock.min),e.newStock.max&&(o.newStock.$lte=e.newStock.max)),e.sold&&(o.sold={},e.sold.min&&(o.sold.$gte=e.sold.min),e.sold.max&&(o.sold.$lte=e.sold.max)),e.textSearch&&(o.$text={$search:e.textSearch}),t(o)})}function makeSortCriteria(e){return new Promise(function(t,n){var o;o=e.criteria,"Descending"===e.order&&(o="-"+o),t(o)})}function generateAddDetails(e){var t=[];return e.forEach(function(e){var n={type:e.type,count:e.count,newStock:e.newStock,sold:e.sold};t.push(n)}),t}function generateUpdateDetails(e,t){return new Promise(function(n,o){t.type&&(e.type=t.type),t.countPlus&&(e.count+=t.countPlus),t.countMinus&&(e.count-=t.countMinus),t.count&&(e.count=t.count),t.newStockPlus&&(e.newStock+=t.newStockPlus),t.newStockMinus&&(e.newStock-=t.newStockMinus),t.newStock&&(e.newStock=t.newStock),t.soldPlus&&(e.sold+=t.soldPlus),t.soldMinus&&(e.sold-=t.soldMinus),t.sold&&(e.sold=t.sold),n(e)})}function convertToAbstract(e,t){return void 0===t&&(t=!1),this.checkThrow(t).then(function(t){return new Promise(function(t,n){var o=[];e.forEach(function(e){var t={id:e._id.toHexString(),type:e.type,count:e.count,newStock:e.newStock,sold:e.sold,createdAt:e.createdAt,updatedAt:e.updatedAt};o.push(t)}),t(o)})})}Object.defineProperty(exports,"__esModule",{value:!0});var Promise=require("bluebird"),generic_model_class_1=require("../../generic-model-class"),generic_event_class_1=require("../../generic-event-class"),model_1=require("./model");exports.default=function(e,t,n){var o=new generic_event_class_1.default(e,"Routers|Amounts");return new generic_model_class_1.default(o,model_1.MongooseModel,t,n,makeConditions,makeSortCriteria,generateAddDetails,generateUpdateDetails,convertToAbstract)};