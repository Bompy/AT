"use strict";function makeConditions(e){return new Promise(function(t,r){var n={};e.type&&(n.type=e.type),e.typeId&&(n.typeId=mongoose.Types.ObjectId(e.typeId)),e.subject&&(n.subject=e.subject),e.timeMeasure&&(n.timeMeasure=e.timeMeasure),e.amount&&(n.amount={},e.amount.min&&(n.amount.$gte=e.amount.min),e.amount.max&&(n.amount.$lte=e.amount.max)),e.textSearch&&(n.$text={$search:e.textSearch}),t(n)})}function makeSortCriteria(e){return new Promise(function(t,r){var n;n=e.criteria,"Descending"===e.order&&(n="-"+n),t(n)})}function generateAddDetails(e){var t=[];return e.forEach(function(e){var r={type:e.type,typeId:mongoose.Types.ObjectId(e.typeId),subject:e.subject,timeMeasure:e.timeMeasure,amount:e.amount};t.push(r)}),t}function generateUpdateDetails(e,t){return new Promise(function(r,n){t.type&&(e.type=t.type),t.typeId&&(e.typeId=mongoose.Types.ObjectId(t.typeId)),t.subject&&(e.subject=t.subject),t.timeMeasure&&(e.timeMeasure=t.timeMeasure),t.amount&&(e.amount=t.amount),r(e)})}function convertToAbstract(e,t){return void 0===t&&(t=!1),this.checkThrow(t).then(function(t){return new Promise(function(t,r){var n=[];e.forEach(function(e){var t={id:e._id.toHexString(),type:e.type,typeId:e.typeId.toHexString(),subject:e.subject,timeMeasure:e.timeMeasure,amount:e.amount,createdAt:e.createdAt,updatedAt:e.updatedAt};n.push(t)}),t(n)})})}Object.defineProperty(exports,"__esModule",{value:!0});var Promise=require("bluebird"),mongoose=require("mongoose"),generic_model_class_1=require("../../generic-model-class"),generic_event_class_1=require("../../generic-event-class"),model_1=require("./model");exports.default=function(e,t,r){var n=new generic_event_class_1.default(e,"Core|Progression");return new generic_model_class_1.default(n,model_1.MongooseModel,t,r,makeConditions,makeSortCriteria,generateAddDetails,generateUpdateDetails,convertToAbstract)};