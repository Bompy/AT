"use strict";function makeConditions(t){return new Promise(function(e,r){var a={};t.track&&(t.track.trackId&&(a["track.trackId"]=mongoose.Types.ObjectId(t.track.trackId)),t.track.trackName&&(a["track.trackName"]=t.track.trackName)),t.product&&(t.product.productId&&(a["product.productId"]=mongoose.Types.ObjectId(t.product.productId)),t.product.label&&(a["product.label"]=t.product.label)),t.quantity&&(a.quantity={},t.quantity.min&&(a.quantity.$gte=t.quantity.min),t.quantity.max&&(a.quantity.$lte=t.quantity.max)),t.value&&(a.value={},t.value.min&&(a.value.$gte=t.value.min),t.value.max&&(a.value.$lte=t.value.max)),t.textSearch&&(a.$text={$search:t.textSearch}),e(a)})}function makeSortCriteria(t){return new Promise(function(e,r){var a;a=t.criteria,"Descending"===t.order&&(a="-"+a),e(a)})}function generateAddDetails(t){var e=[];return t.forEach(function(t){var r={track:{trackId:mongoose.Types.ObjectId(t.track.trackId),trackName:t.track.trackName},product:{productId:mongoose.Types.ObjectId(t.product.productId),label:t.product.label},quantity:t.quantity,value:t.value};e.push(r)}),e}function generateUpdateDetails(t,e){return new Promise(function(r,a){e.track&&(e.track.trackId&&(t.track.trackId=mongoose.Types.ObjectId(e.track.trackId)),e.track.trackName&&(t.track.trackName=e.track.trackName)),e.product&&(e.product.productId&&(t.product.productId=mongoose.Types.ObjectId(e.product.productId)),e.product.label&&(t.product.label=e.product.label)),e.quantity&&(t.quantity=e.quantity),e.value&&(t.value=e.value),r(t)})}function convertToAbstract(t,e){return void 0===e&&(e=!1),this.checkThrow(e).then(function(e){return new Promise(function(e,r){var a=[];t.forEach(function(t){var e={id:t._id.toHexString(),track:{trackId:t.track.trackId.toHexString(),trackName:t.track.trackName},product:{productId:t.product.productId.toHexString(),label:t.product.label},quantity:t.quantity,value:t.value,createdAt:t.createdAt,updatedAt:t.updatedAt};a.push(e)}),e(a)})})}Object.defineProperty(exports,"__esModule",{value:!0});var Promise=require("bluebird"),mongoose=require("mongoose"),generic_model_class_1=require("../../generic-model-class"),generic_event_class_1=require("../../generic-event-class"),model_1=require("./model");exports.default=function(t,e,r){var a=new generic_event_class_1.default(t,"GrocRound|TrackProduct");return new generic_model_class_1.default(a,model_1.MongooseModel,e,r,makeConditions,makeSortCriteria,generateAddDetails,generateUpdateDetails,convertToAbstract)};