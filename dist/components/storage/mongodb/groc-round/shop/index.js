"use strict";function makeConditions(e){return new Promise(function(r,t){var n={};e.shopName&&(n.shopName=e.shopName),e.images&&(n.images={$all:e.images}),e.numProducts&&(n.numProducts={},e.numProducts.min&&(n.numProducts.$gte=e.numProducts.min),e.numProducts.max&&(n.numProducts.$lte=e.numProducts.max)),e.textSearch&&(n.$text={$search:e.textSearch}),r(n)})}function makeSortCriteria(e){return new Promise(function(r,t){var n;n=e.criteria,"Descending"===e.order&&(n="-"+n),r(n)})}function generateAddDetails(e){var r=[];return e.forEach(function(e){var t={shopName:e.shopName,numProducts:e.numProducts};r.push(t)}),r}function generateUpdateDetails(e,r){return new Promise(function(t,n){r.shopName&&(e.shopName=r.shopName),r.images&&(e.images=[],r.images.forEach(function(r){e.images.push(r)})),r.numProductsPlus&&(e.numProducts+=r.numProductsPlus),r.numProductsMinus&&(e.numProducts-=r.numProductsMinus),r.numProducts&&(e.numProducts=r.numProducts),t(e)})}function convertToAbstract(e,r){return void 0===r&&(r=!1),this.checkThrow(r).then(function(r){return new Promise(function(r,t){var n=[];e.forEach(function(e){var r={id:e._id.toHexString(),shopName:e.shopName,numProducts:e.numProducts,createdAt:e.createdAt,updatedAt:e.updatedAt};n.push(r)}),r(n)})})}Object.defineProperty(exports,"__esModule",{value:!0});var Promise=require("bluebird"),generic_model_class_1=require("../../generic-model-class"),generic_event_class_1=require("../../generic-event-class"),model_1=require("./model");exports.default=function(e,r,t){var n=new generic_event_class_1.default(e,"GrocRound|Shop");return new generic_model_class_1.default(n,model_1.MongooseModel,r,t,makeConditions,makeSortCriteria,generateAddDetails,generateUpdateDetails,convertToAbstract)};