"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Promise=require("bluebird"),Registration=function(){return function(e,i,t,r){var n=this;this.events=e,this.checkThrow=i,this.getUserById=t,this.updateUserById=r,this.verifyAccount=function(e,i,t){return n.checkThrow(t).then(function(i){return n.getUserById(e)}).then(function(e){return new Promise(function(t,r){e.verification.verificationCode==i?t():r({identifier:"InvalidCode"})})}).then(function(i){return n.updateUserById(e,{verification:{verified:!0,verificationCode:""}})}).then(function(e){return Promise.resolve()}).catch(function(e){return e.identifier&&"DocumentNotFound"===e.identifier?Promise.reject(e):e.identifier&&"InvalidCode"===e.identifier?Promise.reject(e):Promise.reject({identifier:"VerifyAccountFailed",data:{reason:e}})})}}}();exports.default=Registration;