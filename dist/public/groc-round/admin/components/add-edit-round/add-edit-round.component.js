var GrocRoundAdminAddEditRoundComponent;!function(e){var t=function(){return function(e,t,i,a,n){var s=this;this.$q=e,this.$routeParams=t,this.$location=i,this.ToastService=a,this.RoundsService=n,this.clearMembers=function(){var e=new Date;s.minDate=new Date(2016,e.getMonth(),e.getDate()),s.addDetails={roundName:"",inProgress:!1,duration:{start:new Date,end:new Date,months:0},deliveries:{fee:0}},s.updateDetails={roundName:"",inProgress:!1,duration:{start:new Date,end:new Date,months:0},deliveries:{fee:0}}},this.determineModeAndGetData=function(){s.$routeParams.roundId?(s.editMode=!0,s.getRoundInfo(s.$routeParams.roundId)):s.editMode=!1},this.getRoundInfo=function(e){s.loading=!0,s.RoundsService.getRound(e).then(function(e){s.updateDetails.roundName=e.roundName,s.updateDetails.inProgress=e.inProgress,s.updateDetails.duration.start=e.duration.start,s.updateDetails.duration.end=e.duration.end,s.updateDetails.duration.months=e.duration.months,s.updateDetails.deliveries.fee=e.deliveries.fee}).catch(function(e){s.errorMessage=e&&e.message?e.message:"Couldn't get round record"}).finally(function(){s.loading=!1})},this.getMonths=function(e,t){var i=t.getTime()-e.getTime();return Math.round(i/2592e6)},this.calculateMonths=function(){s.addDetails.duration.months=s.getMonths(s.addDetails.duration.start,s.addDetails.duration.end),s.updateDetails.duration.months=s.getMonths(s.updateDetails.duration.start,s.updateDetails.duration.end),console.log(s.addDetails.duration.months),console.log(s.updateDetails.duration.months)},this.addRound=function(){return s.addDetails.roundName?(s.addDetails.inProgress||(s.addDetails.inProgress=!1),s.addDetails.duration?s.addDetails.duration.start?s.addDetails.duration.end?s.addDetails.duration.start>s.addDetails.duration.end?s.ToastService.showSimple("Duration end date cannot be before the start"):s.addDetails.duration.months?s.addDetails.deliveries?s.addDetails.deliveries.fee?(s.adding=!0,s.RoundsService.addRound(s.addDetails).then(function(e){s.$location.path("/rounds/")}).finally(function(){s.adding=!1})):s.ToastService.showSimple("Delivery fee is missing"):s.ToastService.showSimple("Duration is missing"):s.ToastService.showSimple("Duration span is missing"):s.ToastService.showSimple("Duration end date is missing"):s.ToastService.showSimple("Duration start date is missing"):s.ToastService.showSimple("Duration is missing")):s.ToastService.showSimple("Round name is missing")},this.updateRound=function(){return s.updateDetails.roundName?(s.updateDetails.inProgress||(s.updateDetails.inProgress=!1),s.updateDetails.duration?s.updateDetails.duration.start?s.updateDetails.duration.end?s.updateDetails.duration.start>s.updateDetails.duration.end?s.ToastService.showSimple("Duration end date cannot be before the start"):s.updateDetails.duration.months?s.updateDetails.deliveries?s.updateDetails.deliveries.fee?(s.updating=!0,s.RoundsService.updateRound(s.$routeParams.roundId,s.updateDetails).then(function(e){window.history.back()}).finally(function(){s.updating=!1})):s.ToastService.showSimple("Delivery fee is missing"):s.ToastService.showSimple("Duration is missing"):s.ToastService.showSimple("Duration span is missing"):s.ToastService.showSimple("Duration end date is missing"):s.ToastService.showSimple("Duration start date is missing"):s.ToastService.showSimple("Duration is missing")):s.ToastService.showSimple("Round name is missing")},this.clearMembers(),this.determineModeAndGetData()}}();e.Component=t}(GrocRoundAdminAddEditRoundComponent||(GrocRoundAdminAddEditRoundComponent={}));