var CoreAdminProfileService;!function(e){var s=function(){return function(e,s,r,t,a){var i=this;this.$q=e,this.$http=s,this.$timeout=r,this.ToastService=t,this.ContextsService=a,this.urlPrefix="/core/admin/profile",this.signOut=function(){i.progress.signOut=!0;var e=i.$http.get("/core/auth/signOut").then(function(e){return i.progress.signOut=!1,window.location.href="/passpoint",i.$q.resolve(!0)}).catch(function(e){i.progress.signOut=!1,i.ToastService.showSimple("Something went wrong signing you out")});angular.copy(e,i.promises.signOut)},this.getUser=function(){i.progress.getUser=!0;var e=i.$http.get(i.urlPrefix+"/getDetails").then(function(e){i.progress.getUser=!1;var s=e.data;if(s.success)return i.$timeout(function(){i.user||(i.user={}),angular.copy(s.payload.foundUser,i.user)}),i.$q.resolve(!0);var r=s.message?s.message:"Couldn't get your details";return i.ToastService.showSimple(r),i.$q.reject({message:r})}).catch(function(e){i.progress.getUser=!1;var s=e&&e.message?e.message:"Something went wrong";return i.ToastService.showSimple(s),i.$q.reject({message:s})});return angular.copy(e,i.promises.getUser),i.promises.getUser},this.updateDetails=function(e){return i.progress.updateDetails=!0,i.$http.post(i.urlPrefix+"/updateDetails",e).then(function(e){i.progress.updateDetails=!1;var s=e.data;return s.success?(i.$timeout(function(){angular.copy(s.payload.updatedUser,i.user),i.user.personalDetails&&i.user.personalDetails.dateOfBirth&&(i.user.personalDetails.dateOfBirth=new Date(i.user.personalDetails.dateOfBirth))}),i.ToastService.showSimple("Profile updated"),i.$q.resolve()):i.$q.reject({message:s.message?s.message:""})}).catch(function(e){i.progress.updateDetails=!1;var s=e&&e.message?e.message:"Something went wrong";return i.ToastService.showSimple(s),i.$q.reject({message:s})})},this.changeEmailAddress=function(e,s){var r={password:e,newEmailAddress:s};return i.progress.changeEmailAddress=!0,i.$http.post(i.urlPrefix+"/changeEmailAddress",r).then(function(e){i.progress.changeEmailAddress=!1;var s=e.data;return s.success?(window.location.href="/passpoint",i.$q.resolve()):i.$q.reject({message:s.message?s.message:""})}).catch(function(e){i.progress.changeEmailAddress=!1;var s=e&&e.message?e.message:"Something went wrong";return i.ToastService.showSimple(s),i.$q.reject({message:s})})},this.changePassword=function(e,s){var r={oldPassword:e,newPassword:s};return i.progress.changePassword=!0,i.$http.post(i.urlPrefix+"/changePassword",r).then(function(e){i.progress.changePassword=!1;var s=e.data;return s.success?(i.ToastService.showSimple("Password changed"),i.$q.resolve()):i.$q.reject({message:s.message?s.message:""})}).catch(function(e){i.progress.changePassword=!1;var s=e&&e.message?e.message:"Something went wrong";return i.ToastService.showSimple(s),i.$q.reject({message:s})})},this.progress={getUser:!1,updateDetails:!1,changeEmailAddress:!1,changePassword:!1,signOut:!1},this.promises={getUser:this.$q.resolve(!1),signOut:this.$q.resolve(!1)},this.ContextsService.currentUser?(this.user={},angular.copy(this.ContextsService.currentUser,this.user)):this.getUser()}}();e.Service=s}(CoreAdminProfileService||(CoreAdminProfileService={}));