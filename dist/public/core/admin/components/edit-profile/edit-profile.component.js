var CoreAdminEditProfileComponent;!function(e){var s=function(){return function(e,s,i,t,r,a,n,o){var l=this;this.$q=e,this.$location=s,this.$mdDialog=i,this.ToastService=t,this.CountriesService=r,this.ProfileService=a,this.ChangeEmailAddressService=n,this.ChangePasswordService=o,this.initMembers=function(){var e=new Date;l.minDate=new Date(1927,e.getMonth(),e.getDate()),l.maxDate=new Date(e.getFullYear()-13,e.getMonth(),e.getDate()),l.errorMessage="",l.countries=l.CountriesService.list,l.promises=l.ProfileService.promises,l.progress=l.ProfileService.progress},this.fetchUser=function(){l.fetchDone(l.ProfileService.getUser())},this.connectToPromise=function(){l.fetchDone(l.promises.getUser)},this.fetchDone=function(e){e.then(function(e){e&&l.copyDetails()}).catch(function(e){l.errorMessage=e&&e.message?e.message:"Couldn't get user details"}).finally(function(){l.promises.getUser=l.$q.resolve(!1)})},this.copyDetails=function(){if(l.details={personalDetails:{firstName:"",lastName:"",dateOfBirth:void 0,gender:null},contactDetails:{phoneNumbers:[]},residentialDetails:{country:"",province:"",address:""}},l.emailAddress=l.ProfileService.user.emailAddress,l.ProfileService.user.personalDetails){var e=l.ProfileService.user.personalDetails;e.firstName&&(l.details.personalDetails.firstName=e.firstName),e.lastName&&(l.details.personalDetails.lastName=e.lastName),e.dateOfBirth&&(l.details.personalDetails.dateOfBirth=e.dateOfBirth),e.gender&&(l.details.personalDetails.gender=e.gender)}if(l.ProfileService.user.contactDetails){var s=l.ProfileService.user.contactDetails;s.phoneNumbers&&s.phoneNumbers.length&&(l.details.contactDetails.phoneNumbers=[],s.phoneNumbers.forEach(function(e){l.details.contactDetails.phoneNumbers.push(e)}))}if(l.ProfileService.user.residentialDetails){var i=l.ProfileService.user.residentialDetails;i.country&&(l.details.residentialDetails.country=i.country),i.province&&(l.details.residentialDetails.province=i.province),i.address&&(l.details.residentialDetails.address=i.address)}},this.openChangeEmailAddress=function(e){var s={controller:["$mdDialog",function(e){return l.ChangeEmailAddressService}],controllerAs:"vm",templateUrl:"/core/admin/services/change-email-address/change-email-address.template.html",parent:angular.element(document.body),targetEvent:e,openFrom:"#change_email_address",closeTo:"#change_email_address",clickOutsideToClose:!1};return l.$mdDialog.show(s).then(function(e){return l.ProfileService.changeEmailAddress(e.password,e.newEmailAddress)})},this.openChangePassword=function(e){var s={controller:["$mdDialog",function(e){return l.ChangePasswordService}],controllerAs:"vm",templateUrl:"/core/admin/services/change-password/change-password.template.html",parent:angular.element(document.body),targetEvent:e,openFrom:"#change_password",closeTo:"#change_password",clickOutsideToClose:!1};return l.$mdDialog.show(s).then(function(e){return l.ProfileService.changePassword(e.oldPassword,e.newPassword)})},this.saveChanges=function(){return l.details.personalDetails.firstName?l.details.personalDetails.lastName?l.details.personalDetails.dateOfBirth?l.details.personalDetails.gender?l.details.contactDetails.phoneNumbers&&l.details.contactDetails.phoneNumbers.length?l.details.residentialDetails.country?l.details.residentialDetails.province?l.details.residentialDetails.address?l.ProfileService.updateDetails(l.details).then(function(e){l.$location.path("/profile")}):l.ToastService.showSimple("Address is missing"):l.ToastService.showSimple("Province is missing"):l.ToastService.showSimple("Country is missing"):l.ToastService.showSimple("Phone numbers are missing"):l.ToastService.showSimple("Gender is missing"):l.ToastService.showSimple("Date of birth is missing"):l.ToastService.showSimple("Last name is missing"):l.ToastService.showSimple("First name is missing")},this.initMembers(),this.ProfileService.user?this.copyDetails():this.ProfileService.progress.getUser?this.connectToPromise():this.fetchUser()}}();e.Component=s}(CoreAdminEditProfileComponent||(CoreAdminEditProfileComponent={}));