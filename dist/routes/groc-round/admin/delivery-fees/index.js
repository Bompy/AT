"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var express=require("express"),coreValidationAdd=require("../../../core/validation-add"),coreValidationUpdate=require("../../../core/validation-update"),validationAdd=require("../../validation-add"),validationUpdate=require("../../validation-update");exports.default=function(e,n,t,r,d,i){function o(e){return!!coreValidationUpdate.user(e)||(!!validationUpdate.round(e)||(!(!e.body.payment||"object"==typeof e.body.payment)||(!(!e.body.payment.identifier||"string"==typeof e.body.payment.identifier)||(!(!e.body.payment.amount||"number"==typeof e.body.payment.amount)||!(!e.body.payment.identifier||"string"==typeof e.body.payment.identifier)))))}function u(e){return!!coreValidationAdd.user(e)||(!!validationAdd.round(e)||(!e.body.payment||"object"!=typeof e.body.payment||(!e.body.payment.identifier||"string"!=typeof e.body.payment.identifier||(!e.body.payment.amount||"number"!=typeof e.body.payment.amount||(!e.body.payment.identifier||"string"!=typeof e.body.payment.identifier)))))}var a=express.Router();return a.get("/getDeliveryFees",function(n,t,r){var d={};return n.query.userId&&(d.user={userId:n.query.userId}),n.query.roundId&&(d.round={roundId:n.query.roundId}),e(d,null,null).then(function(e){return i(t,"grocRound-admin",!0,null,{foundDeliveryFees:e,innerContext:"get-deliveryFees"})}).catch(function(e){return i(t,"grocRound-admin",!1,null,{innerContext:"get-deliveryFees"})})}),a.get("/getDeliveryFee/:deliveryFeeId",function(e,t,r){return e.params.deliveryFeeId?n(e.params.deliveryFeeId).then(function(e){return i(t,"grocRound-admin",!0,null,{foundDeliveryFee:e,innerContext:"get-deliveryFee"})}).catch(function(e){return e&&e.identifier&&"DocumentNotFound"===e.identifier?i(t,"grocRound-admin",!1,"Couldn't find deliveryFee",{innerContext:"get-deliveryFee"}):i(t,"grocRound-admin",!1,null,{innerContext:"get-deliveryFee"})}):i(t,"grocRound-admin",!1,"DeliveryFee ID is missing",{innerContext:"get-deliveryFee"})}),a.post("/addDeliveryFee",function(e,n,r){if(u(e))return i(n,"grocRound-admin",!1,"Something is wrong with the data you sent",{innerContext:"add-deliveryFee"});var d={user:e.body.user,round:e.body.round,payment:e.body.payment};return t(d).then(function(e){return i(n,"grocRound-admin",!0,null,{addedDeliveryFee:e,innerContext:"add-deliveryFee"})}).catch(function(e){return i(n,"grocRound-admin",!1,null,{innerContext:"add-deliveryFee"})})}),a.post("/updateDeliveryFee/:deliveryFeeId",function(e,n,t){var d="update-deliveryFee";if(!e.params.deliveryFeeId)return i(n,"grocRound-admin",!1,"Update id is missing",{innerContext:d});if(o(e))return i(n,"grocRound-admin",!1,"Something is wrong with the data you sent",{innerContext:d});var u={};return e.body.user&&(u.user=e.body.user),e.body.round&&(u.round=e.body.round),e.body.payment&&(u.payment=e.body.payment),r(e.params.deliveryFeeId,u).then(function(e){return i(n,"grocRound-admin",!0,null,{updatedDeliveryFee:e,innerContext:d})}).catch(function(e){return e&&e.identifier&&"DocumentNotFound"===e.identifier?i(n,"grocRound-admin",!1,"Couldn't find deliveryFee",{innerContext:d}):i(n,"grocRound-admin",!1,null,{innerContext:d})})}),a.get("/deleteDeliveryFee/:deliveryFeeId",function(e,n,t){return e.params.deliveryFeeId?d(e.params.deliveryFeeId).then(function(e){return i(n,"grocRound-admin",!0,null,{innerContext:"delete-deliveryFee"})}).catch(function(e){return e&&e.identifier&&"DocumentNotFound"===e.identifier?i(n,"grocRound-admin",!1,"Couldn't find deliveryFee",{innerContext:"delete-deliveryFee"}):i(n,"grocRound-admin",!1,null,{innerContext:"delete-deliveryFee"})}):i(n,"grocRound-admin",!1,"DeliveryFee ID is missing",{innerContext:"delete-deliveryFee"})}),a};