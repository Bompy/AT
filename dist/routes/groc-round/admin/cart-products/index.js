"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var express=require("express"),coreValidationAdd=require("../../../core/validation-add"),coreValidationUpdate=require("../../../core/validation-update"),validationAdd=require("../../validation-add"),validationUpdate=require("../../validation-update");exports.default=function(t,r,n,d,o,e){function u(t){return!!coreValidationUpdate.user(t)||(!!validationUpdate.round(t)||(!!validationUpdate.product(t)||(!t.body.quantity||"number"!=typeof t.body.quantity)&&(t.body.value&&t.body.value,!1)))}function a(t){return!!coreValidationAdd.user(t)||(!!validationAdd.round(t)||(!t.body.cartId||"string"!=typeof t.body.cartId||(!!validationAdd.product(t)||!(!t.body.quantity||"number"!=typeof t.body.quantity)&&(t.body.value&&t.body.value,!1))))}var c=express.Router();return c.get("/getCartProducts",function(r,n,d){var o=null;return r.query.cartId&&(o={cartId:r.query.cartId}),t(o,null,null).then(function(t){return e(n,"grocRound-admin",!0,null,{foundCartProducts:t,innerContext:"get-cartProducts"})}).catch(function(t){return e(n,"grocRound-admin",!1,null,{innerContext:"get-cartProducts"})})}),c.get("/getCartProduct/:cartProductId",function(t,n,d){return t.params.cartProductId?r(t.params.cartProductId).then(function(t){return e(n,"grocRound-admin",!0,null,{foundCartProduct:t,innerContext:"get-cartProduct"})}).catch(function(t){return t&&t.identifier&&"DocumentNotFound"===t.identifier?e(n,"grocRound-admin",!1,"Couldn't find cartProduct",{innerContext:"get-cartProduct"}):e(n,"grocRound-admin",!1,null,{innerContext:"get-cartProduct"})}):e(n,"grocRound-admin",!1,"CartProduct ID is missing",{innerContext:"get-cartProduct"})}),c.post("/addCartProduct",function(t,r,d){if(a(t))return e(r,"grocRound-admin",!1,"Something is wrong with the data you sent",{innerContext:"add-cartProduct"});var o={user:t.body.user,round:t.body.round,cartId:t.body.cartId,product:t.body.product};return n(o).then(function(t){return e(r,"grocRound-admin",!0,null,{addedCartProduct:t,innerContext:"add-cartProduct"})}).catch(function(t){return e(r,"grocRound-admin",!1,null,{innerContext:"add-cartProduct"})})}),c.post("/updateCartProduct/:cartProductId",function(t,r,n){var o="update-cartProduct";if(!t.params.cartProductId)return e(r,"grocRound-admin",!1,"CartProduct ID is missing",{innerContext:o});if(u(t))return e(r,"grocRound-admin",!1,"Something is wrong with the data you sent",{innerContext:o});var a={};return t.body.user&&(a.user=t.body.user),t.body.round&&(a.round=t.body.round),t.body.product&&(a.product=t.body.product),d(t.params.cartProductId,a).then(function(t){return e(r,"grocRound-admin",!0,null,{updatedCartProduct:t,innerContext:o})}).catch(function(t){return t&&t.identifier&&"DocumentNotFound"===t.identifier?e(r,"grocRound-admin",!1,"Couldn't find cartProduct",{innerContext:o}):e(r,"grocRound-admin",!1,null,{innerContext:o})})}),c.get("/deleteCartProduct/:cartProductId",function(t,r,n){return t.params.cartProductId?o(t.params.cartProductId).then(function(t){return e(r,"grocRound-admin",!0,null,{innerContext:"delete-cartProduct"})}).catch(function(t){return t&&t.identifier&&"DocumentNotFound"===t.identifier?e(r,"grocRound-admin",!1,"Couldn't find cartProduct",{innerContext:"delete-cartProduct"}):e(r,"grocRound-admin",!1,null,{innerContext:"delete-cartProduct"})}):e(r,"grocRound-admin",!1,"CartProduct ID is missing",{innerContext:"delete-cartProduct"})}),c};