"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var express=require("express"),blocks=require("../../../validation/validation-blocks"),v=require("../../../validation/validation-revised");exports.default=function(t,n,r,o,e,u){function d(t){return!!blocks.absentWrong(t.body,"quantity","number")||!!blocks.absentWrong(t.body,"value","number")}function c(t){return!!v.track.absent(t.body)||(!!v.product.absent(t.body)||(!!blocks.absentWrong(t.body,"quantity","number")||!!blocks.absentWrong(t.body,"value","number")))}var a=express.Router();return a.get("/getTrackProducts",function(n,r,o){var e={};return n.query.trackId&&(e.track={trackId:n.query.trackId}),t(e,null,null).then(function(t){return u(r,"grocRound-admin",!0,null,{foundTrackProducts:t,innerContext:"get-trackProducts"})}).catch(function(t){return u(r,"grocRound-admin",!1,null,{innerContext:"get-trackProducts"})})}),a.get("/getTrackProduct/:trackProductId",function(t,r,o){return t.params.trackProductId?n(t.params.trackProductId).then(function(t){return u(r,"grocRound-admin",!0,null,{foundTrackProduct:t,innerContext:"get-trackProduct"})}).catch(function(t){return t&&t.identifier&&"DocumentNotFound"===t.identifier?u(r,"grocRound-admin",!1,"Couldn't find trackProduct",{innerContext:"get-trackProduct"}):u(r,"grocRound-admin",!1,null,{innerContext:"get-trackProduct"})}):u(r,"grocRound-admin",!1,"TrackProduct ID is missing",{innerContext:"get-trackProduct"})}),a.post("/addTrackProduct",function(t,n,o){if(c(t))return u(n,"grocRound-admin",!1,"Something is wrong with the data you sent",{innerContext:"add-trackProduct"});var e={track:t.body.track,product:t.body.product,quantity:t.body.quantity,value:t.body.value};return r(e).then(function(t){return u(n,"grocRound-admin",!0,null,{addedTrackProduct:t,innerContext:"add-trackProduct"})}).catch(function(t){return u(n,"grocRound-admin",!1,null,{innerContext:"add-trackProduct"})})}),a.post("/updateTrackProduct/:trackProductId",function(t,n,r){var e="update-trackProduct";if(!t.params.trackProductId)return u(n,"grocRound-admin",!1,"Update id is missing",{innerContext:e});if(d(t))return u(n,"grocRound-admin",!1,"Something is wrong with the data you sent",{innerContext:e});var c={};return t.body.quantity&&(c.quantity=t.body.quantity),t.body.value&&(c.value=t.body.value),o(t.params.trackProductId,c).then(function(t){return u(n,"grocRound-admin",!0,null,{updatedTrackProduct:t,innerContext:e})}).catch(function(t){return t&&t.identifier&&"DocumentNotFound"===t.identifier?u(n,"grocRound-admin",!1,"Couldn't find trackProduct",{innerContext:e}):u(n,"grocRound-admin",!1,null,{innerContext:e})})}),a.get("/deleteTrackProduct/:trackProductId",function(t,n,r){var o="delete-trackProduct";return t.params.trackProductId?e(t.params.trackProductId).then(function(t){return u(n,"grocRound-admin",!0,null,{innerContext:o})}).catch(function(t){return t&&t.identifier&&"DocumentNotFound"===t.identifier?u(n,"grocRound-admin",!1,"Couldn't find trackProduct",{innerContext:o}):u(n,"grocRound-admin",!1,null,{innerContext:o})}):u(n,"grocRound-admin",!1,"TrackProduct ID is missing",{innerContext:o})}),a};