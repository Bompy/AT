"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var express=require("express");exports.default=function(e,r,n,o,d,i){var t=express.Router();return t.get("/getProducts",function(r,n,o){return e(null,null,null).then(function(e){return i(n,"grocRound-admin",!0,null,{foundProducts:e,innerContext:"get-products"})}).catch(function(e){return i(n,"grocRound-admin",!1,null,{innerContext:"get-products"})})}),t.get("/getProduct/:productId",function(e,n,o){return e.params.productId?r(e.params.productId).then(function(e){return i(n,"grocRound-admin",!0,null,{foundProduct:e,innerContext:"get-product"})}).catch(function(e){return e&&e.identifier&&"DocumentNotFound"===e.identifier?i(n,"grocRound-admin",!1,"Couldn't find product",{innerContext:"get-product"}):i(n,"grocRound-admin",!1,null,{innerContext:"get-product"})}):i(n,"grocRound-admin",!1,"Product ID is missing",{innerContext:"get-product"})}),t.post("/addProduct",function(e,r,o){if(!e.body.label)return i(r,"grocRound-admin",!1,"Product label is missing",{innerContext:"add-product"});var d={label:e.body.label,prices:[],priceValues:{min:{price:0},max:{price:0},median:{price:0},mean:{price:0}},effectivePrice:{price:0}};return e.body.prices&&e.body.prices.forEach(function(e){d.prices.push({shop:{shopId:e.shop.shopId,shopName:e.shop.shopName},quantity:e.quantity,price:e.price})}),e.body.effectivePrice&&(d.effectivePrice.price=e.body.effectivePrice.price,e.body.effectivePrice.shopId&&(d.effectivePrice.shopId=e.body.effectivePrice.shopId)),e.body.images&&(d.images=[],e.body.images.forEach(function(e){d.images.push(e)})),n(d).then(function(e){return i(r,"grocRound-admin",!0,null,{addedProduct:e,innerContext:"add-product"})}).catch(function(e){return i(r,"grocRound-admin",!1,null,{innerContext:"add-product"})})}),t.post("/updateProduct/:productId",function(e,r,n){if(!e.params.productId)return i(r,"grocRound-admin",!1,"Product ID is missing",{innerContext:"update-product"});var d={};return e.body.label&&(d.label=e.body.label),e.body.images&&(d.images=e.body.images),e.body.prices&&(d.prices=e.body.prices),e.body.priceValues&&(d.priceValues={},e.body.priceValues.min&&(d.priceValues.min={price:e.body.priceValues.min.price},e.body.priceValues.min.shopId&&(d.priceValues.min.shopId=e.body.priceValues.min.shopId)),e.body.priceValues.max&&(d.priceValues.max={price:e.body.priceValues.max.price},e.body.priceValues.max.shopId&&(d.priceValues.max.shopId=e.body.priceValues.max.shopId)),e.body.priceValues.median&&(d.priceValues.median={price:e.body.priceValues.median.price},e.body.priceValues.median.shopId&&(d.priceValues.median.shopId=e.body.priceValues.median.shopId)),e.body.priceValues.mean&&(d.priceValues.mean={price:e.body.priceValues.mean.price},e.body.priceValues.mean.shopId&&(d.priceValues.mean.shopId=e.body.priceValues.mean.shopId))),e.body.effectivePrice&&(d.effectivePrice={price:e.body.effectivePrice.price},e.body.effectivePrice.shopId&&(d.effectivePrice.shopId=e.body.effectivePrice.shopId)),o(e.params.productId,d).then(function(e){return i(r,"grocRound-admin",!0,null,{updatedProduct:e,innerContext:"update-product"})}).catch(function(e){return e&&e.identifier&&"DocumentNotFound"===e.identifier?i(r,"grocRound-admin",!1,"Couldn't find product",{innerContext:"update-product"}):i(r,"grocRound-admin",!1,null,{innerContext:"update-product"})})}),t.get("/deleteProduct/:productId",function(e,r,n){return e.params.productId?d(e.params.productId).then(function(e){return i(r,"grocRound-admin",!0,null,{innerContext:"delete-product"})}).catch(function(e){return e&&e.identifier&&"DocumentNotFound"===e.identifier?i(r,"grocRound-admin",!1,"Couldn't find product",{innerContext:"delete-product"}):i(r,"grocRound-admin",!1,null,{innerContext:"delete-product"})}):i(r,"grocRound-admin",!1,"Product ID is missing",{innerContext:"delete-product"})}),t};