"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var express=require("express");exports.default=function(n,o,e,t,r,i){function d(n){if(n.body.shopName&&"string"!=typeof n.body.shopName)return!0;if(n.body.images){if(!Array.isArray(n.body.images))return!0;n.body.images.forEach(function(n){if("string"!=typeof n)return!0})}return!(!n.body.numProducts||"number"==typeof n.body.numProducts)}function u(n){if(!n.body.shopName||"string"!=typeof n.body.shopName)return!0;if(n.body.images){if(!Array.isArray(n.body.images))return!0;n.body.images.forEach(function(n){if("string"!=typeof n)return!0})}return!1}var s=express.Router();return s.get("/getShops",function(o,e,t){return n(null,null,null).then(function(n){return i(e,"grocRound-admin",!0,null,{foundShops:n,innerContext:"get-shops"})}).catch(function(n){return i(e,"grocRound-admin",!1,null,{innerContext:"get-shops"})})}),s.get("/getShop/:shopId",function(n,e,t){return n.params.shopId?o(n.params.shopId).then(function(n){return i(e,"grocRound-admin",!0,null,{foundShop:n,innerContext:"get-shop"})}).catch(function(n){return n&&n.identifier&&"DocumentNotFound"===n.identifier?i(e,"grocRound-admin",!1,"Couldn't find shop",{innerContext:"get-shop"}):i(e,"grocRound-admin",!1,null,{innerContext:"get-shop"})}):i(e,"grocRound-admin",!1,"Shop ID is missing",{innerContext:"get-shop"})}),s.post("/addShop",function(n,o,t){if(u(n))return i(o,"grocRound-admin",!1,"Something is wrong with the data you sent",{innerContext:"add-shop"});var r={shopName:n.body.shopName,numProducts:0};return n.body.images&&(r.images=[],n.body.images.forEach(function(n){r.images.push(n)})),e(r).then(function(n){return i(o,"grocRound-admin",!0,null,{addedShop:n,innerContext:"add-shop"})}).catch(function(n){return i(o,"grocRound-admin",!1,null,{innerContext:"add-shop"})})}),s.post("/updateShop/:shopId",function(n,o,e){if(!n.params.shopId)return i(o,"grocRound-admin",!1,"Update id is missing",{innerContext:"update-shop"});if(d(n))return i(o,"grocRound-admin",!1,"Something is wrong with the data you sent",{innerContext:"update-shop"});var r={};return n.body.shopName&&(r.shopName=n.body.shopName),n.body.images&&(r.images=n.body.images),t(n.params.shopId,r).then(function(n){return i(o,"grocRound-admin",!0,null,{updatedShop:n,innerContext:"update-shop"})}).catch(function(n){return n&&n.identifier&&"DocumentNotFound"===n.identifier?i(o,"grocRound-admin",!1,"Couldn't find shop",{innerContext:"update-shop"}):i(o,"grocRound-admin",!1,null,{innerContext:"update-shop"})})}),s.get("/deleteShop/:shopId",function(n,o,e){return n.params.shopId?r(n.params.shopId).then(function(n){return i(o,"grocRound-admin",!0,null,{innerContext:"delete-shop"})}).catch(function(n){return n&&n.identifier&&"DocumentNotFound"===n.identifier?i(o,"grocRound-admin",!1,"Couldn't find shop",{innerContext:"delete-shop"}):i(o,"grocRound-admin",!1,null,{innerContext:"delete-shop"})}):i(o,"grocRound-admin",!1,"Shop ID is missing",{innerContext:"delete-shop"})}),s};