"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var express=require("express"),registration_1=require("./registration");exports.default=function(e,r,s){var n=express.Router();return n.use("/registration",registration_1.default(e.storage.core.user.get,e.helpers.numbers.generateRandomNumber,e.authentication.createHashedPassword,e.storage.core.user.add,r.core.common.mailTemplates.newEmailAddress,e.communication.mailAgent.sendEmail,e.response.send)),n.get("/",function(r,s,n){function t(){return e.response.send(s,"passpoint",!1,"You need to sign in first",null)}return e.session.signedIn(r)?e.session.getCurrentUser(r).then(function(e){return"consumer"==e.accessLevel?(s.locals.currentUser=e,n()):t()}):t()},function(r,s,n){return e.response.send(s,"core-consumer",!0,null,{currentUser:s.locals.currentUser})}),n};